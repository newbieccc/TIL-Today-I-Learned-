# SQL 응용 - 단원종합문제

## 데이터베이스 기본 / 응용 SQL 작성하기 / 절차형 SQL 활용하기

### 01. 커밋(COMMIT)에 대해 서술하시요

|||
|:--:|--|
|롤백</br>(ROLLBACK)|오류가 발생했을 때, 오류 이전의 특정 시점(SAVEPOINT, CHECKPOINT) 상태로 되돌려주는 제어어|
|`커밋`</br>`(COMMIT)`|`트랜잭션을 메모리에 영구적으로 저장하는 제어어`|
|체크포인트|ROLLBACK을 위한 시점을 지정하는 제어어|
|||

---

### 02. 튜플 수 구하기

>- 컴퓨터과 학생 = 50명
>- 인터넷과 학생 = 100명
>- 사무자동화학과 학생 50명
>- DEPT 컬럼은 학과명이다

- (1). SELECT DEPT FROM STUDENT;
- (2). SELECT DISTINCT DEPT FROM STUDENT;
- (3). SELECT COUNT(DISTINCT DEPT) FROM STUDENT;
  - `200`/`3`/`1`

>- 단순 SELECT(조건검색)의 경우 전체 테이블의 튜플을 검색하기 때문에 200건(=50+100+50)이 조회된다.
>- DISTINCT(중복제거)의 경우 동일한 튜플을 제거하고 검색하기 때문에 '컴퓨터과' 1건, '인터넷과' 1건, '사무자동화학과' 1건으로 총 3건이 조회된다.
>- GROUP BY가 없을 경우 전체 테이블에서 튜플 개수를 COUNT를 통해 출력하기 때문에 출력값을 표현한 1개가 튜플이다.

---

### 03. 알맞는 쿼리 작성

- 사원 테이블에 생년월일이라는 컬럼을 삭제하고자 한다.
  - `ALTER TABLE 사원 DROP 생년월일`

>- ALTER TABLE에서 컬럼을 삭제하는 문법은 다음과 같다
>- ALTER TABLE 테이블명 DROP 컬럼명;

---

### 04. 알맞는 쿼리 작성

- 사람이라는 테이블을 만들려고 한다
- 이름, 생년월일이라는 컬럼이 있는데,
- 이름 = VARCHAR(10) 데이터 타입
- 생년월일 = CHAR(8) 데이터 타입
- 생년월일은 추가로 NULL을 가질 수 없도록 제약 조건을 걸고자 한다.
  - `CREATE TABLE 사람 (`
  - &nbsp;&nbsp;&nbsp;&nbsp;`이름 VARCHAR(10),`
  - &nbsp;&nbsp;&nbsp;&nbsp;`생년월일 CHAR(8) NOT NULL`
  - `);`

>- CREATE TABLE의 상세 문법은 다음과 같다.

```sql
//sql
CREATE TABLE 테이블명 (
  컬럼명 데이터타입 PRIMARY KEY, //기본키 설정
  컬럼명 데이터타입 FOREIGN KEY REFERENCES 참조테이블 (기본키), //외래키 설정
  컬럼명 데이터타입 UNIQUE,
  컬럼명 데이터타입 NOT NULL,
  컬럼명 데이터타입 CHECK(조건식) // 제약조건 설정
  컬럼명 데이터타입 DEFAULT 값
)
```

---

### 05. 뷰를 생성하는 SQL을 작성

- 학생 테이블에서 전공이 '전산'인 학번, 이름으로 학생뷰라는 이름의 뷰를 생성
  - `CREATE VIEW 학생뷰 AS SELECT 학번, 이름 FROM 학생 WHERE 전공 = '전산';`

>- 뷰를 생성하는 명령은 다음과 같다
</br>- CREATE VIEW 뷰이름 AS 조회쿼리
>- 학생 테이블에서 전공이 '전산'인 학번, 이름으로 학생 뷰라는 이름의 뷰를 생성하므로
>- CREATE VIEW 학생뷰 AS 뒤에
>- SELECT 절에는 학번, 이름, FROM 절에는 학생 WHERE 절은 전공이 '전산'으로 한다.

---

### 06. 인덱스를 생성하는 SQL 문 작성

- 학생 테이블의 학번 컬럼에 대해 학번인덱스라는 인덱스명으로 인덱스를 생성
  - `CREATE INDEX 학번인덱스 ON 학생(학번);`

>- 인덱스를 생성하는 명령어
</br>CREATE INDEX 인덱스명 ON 테이블명(컬럼명1, 컬럼명2, ...);
>- 인덱스명은 학번인덱스이고, 테이블명은 학생, 컬럼은 학번으로 해서 인덱스를 생성한다.

---

### 07. 조건을 만족하는 테이블을 생성하는 SQL문 작성

- 테이블명은 교수
- VARCHAR 타입의 사이즈가 10인 교번이고 PRIMARY KEY인 컬럼
- VARCHAR 타입의 사이즈가 10인 이름 컬럼
- VARCHAR타입의 사이즈가 8이면서 Null을 허용하지 않는 임용일 컬럼
  - `CREATE TABLE 교수 (`
  - &nbsp;&nbsp;&nbsp;&nbsp;`교번 VARCHAR(10) PRIMARY KEY,`
  - &nbsp;&nbsp;&nbsp;&nbsp;`이름 VARCHAR(10),`
  - &nbsp;&nbsp;&nbsp;&nbsp;`임용일 VARCHAR(8) NOT NULL,`
  - `);`

>- 테이블을 생성하는 명령어
>- CREATE TABLE 테이블명( 컬럼명 데이터타입 [제약조건], ... )

---

### 08. 성적 테이블에 학점 컬럼을 추가하는 SQL문을 작성

- 학점 컬럼은 VARCHAR 타입이고 사이즈는 4이고 NULL을 허용하지 않음
  - `ALTER TABLE 성적 ADD 학점 VARCHAR(4) NOT NULL`

>- TABLE에 컬럼을 추가하는 문법
</br> ALTER TABLE 테이블명 ADD 컬럼명 데이터타입 [제약조건]
>- 테이블명은 성적, 컬럼명은 학점, 데이터타입은 VARCHAR, 사이즈는 4, NULL을 허용하지 않으므로 NOT NULL로 작성한다.

---

### 09. 학생 테이블에서 전산과를 출력하는 SQL문 작성

- WHERE 절 조건을 이용하여 학과가 전산과인 행을 출력
  - `SELECT 학번, 이름 FROM 학생 WHERE 학과 = '전산과';`

---

### 10. 급여 테이블에서 부서별의 급여합계를 출력하는 SQL문을 작성

- 급여합계는 급여 컬럼의 값들의 합이며 AS를 사용하여 '급여합계'로 출력
  - `SELECT 부서, SUM(급여) AS 급여합계 FROM 급여 GROUP BY 부서;`

>- 부서별 급여합계를 구하기 위해서는 GROUP BY를 사용한다
>- SELECT 절에서 컬럼명을 급여합계로 출력하기 위해 SUM(급여) 뒤에 AS를 사용한다

---

### 11. 급여 테이블에서 부서의 급여합계가 6,000이상인 부서, 급여합계를 출력하는 SQL 문을 작성하시오

- 급여합계는 급여 컬럼의 값들의 합이며 AS를 사용하여 '급여합계'로 출력
  - `SELECT 부서, SUM(급여) AS 급여합계 FROM 급여 GROUP BY 부서 HAVING 급여합계 >= 6000;`

>- 부서별 급여합계를 구하기 위해서는 GROUP BY를 사용한다
>- SELECT 절에서 컬럼명을 급여합계로 출력하기 위해 SUM(급여) 뒤에 AS를 사용한다

---

### 12. 주어진 성적테이블에서 다음을 만족하는 SQL을 작성하시오

- SELECT 절에 '*'을 사용하지 않음
- 학점은 내림차순 정렬, 같은 값일 때 이름을 오름차순으로 정렬함
  - `SELECT 이름, 과목, 학점 FROM 성적 ORDER BY 학점 DESC, 이름 ASC;`

>- ORDER BY 절은 속성값을 정렬하고자 할 때 사용한다
</br>(ASC: 오름차순, DESC: 내림차순, ASC, DESC 키워드 생략 시 오름차순 정렬)
>- ORDER BY 속성 [ASC | DESC]
>- 학점은 내림차순, 그 다음에 학점이 같을 경우 이름이 오름차순이므로 ORDER BY 절에 학점, 이름 순서로 쿼리를 작성한다

---

### 13. 주어진 도서 테이블과 도서가격 테이블을 내부 조인(Inner Join)하는 SQL 문을 작성하시오

- FROM 절에서 도서는 A, 도서가격은 B로 별칭을 줌
- 도서 테이블의 책번호와 도서가격 테이블의 책번호는 ON절에서 조인 조건으로 사용
  - `SELECT A.책번호, A.책명, B.가격 FROM 도서 A JOIN 도서가격 B ON A.책번호=B.책번호;`

>- 내부 조인 문법은 다음과 같다
>- SELECT A.컬럼1, A.컬럼2, ... , B.컬럼1, B.컬럼2
</br>FROM 테이블1 A [Inner] JOIN 테이블2 B
</br> ON 조인 조건
</br>[WHERE 검색조건];

---

### 14. 주어진 도서 테이블과 도서가격 테이블을 완전 외부 조인(Full Outer Join)하는 SQL문을 작성

- FROM 절에서 도서는 A, 도서가격은 B로 별칭을 줌
- 도서 테이블의 책번호와 도서가격 테이블의 책번호는 ON 절에서 조인 조건으로 사용
  - `SELECT A.책번호, A.책명, B.책번호, B.가격 FROM 도서 A FULL OUTER JOIN 도서가격 B ON A.책번호=B.책번호;`

>- 완전 외부 조인(full outer join)문법
>- SELECT A.컬럼1, A.컬럼2, ... , B.컬럼1, B.컬럼2
</br>FROM 테이블1 A FULL [OUTER] JOIN 테이블2 B
</br> ON 조인 조건
</br>[WHERE 검색조건];

---

### 15. 도서 테이블과 도서가격 테이블에서 아래를 만족하는 SQL 문 작성

- WHERE 절에서 IN 연산자를 사용하며 IN 연산자의 조건에 서브쿼리를 사용
- 책명이 자료구조인 가격 중에 가장 비싼 값을 도서 가격 테이블에서 서브쿼리함
  - `SELECT MAX(가격) AS 가격 FROM 도서가격 WHERE 책번호 IN (SELECT 책번호 FROM 도서 WHERE 책명='자료구조');`

>- IN 연산자에서 서브쿼리를 사용하며, 도서 테이블에서 자료구조인 책명의 책번호를 서브쿼리 한다.
>- 도서가격 중에서 가장 비싼 가격을 구하기 위해 SELECT 절에서 MAX를 사용한다.

---

### 16. 데이터의 내용을 삽입하는 SQL문을 작성

- `INSERT INTO 학생 (학번, 성명, 학년, 수강과목) VALUES (3000, '장길산', 3, '수학');`

>- INSERT 명령어
>- INSERT INTO 테이블명(속성명1, ... ) VALUES (데이터1, ... );

---

### 17. 학생 테이블에서 학번이 1000인 데이터에서 수강과목을 수학에서 영어로 변경하는 쿼리를 작성하시오 (단, WHERE 조건에서 학번 이외의 컬럼을 사용하지 않는다.)

- `UPDATE 학생 SET 수강과목 = '영어' WHERE 학번 = 1000;`

>- UPDATE 명령어
>- UPDATE 테이블명 SET 속성명 = 데이터, ... WHERE 조건;

---

### 18. 학생 테이블에서 학번이 3000인 데이터를 삭제하는 쿼리를 작성하시오. (단, WHERE 조건에서 학번 이외의 컬럼을 사용하지 않는다.)

- `DELETE FROM 학생 WHERE 학번=3000;`

>- DELETE 명령어
>- DELETE FROM 테이블명 WHERE 조건;
>- 도서 테이블에서 데이터를 삭제하기 위해 WHERE 절에서 학번이 3000인 값을 구한다.

---

### 19. 데이터베이스 관리자가 권한을 부여하는 DCL 문을 작성하시오

- 관리자가 사용자 홍길동에게 '사원'테이블에 대해 SELECT 할 수 있는 권한을 부여
  - `GRANT SELECT ON 사원 TO 홍길동;`

>- 권한을 부여하기 위해 GRANT 명령어를 사용한다
>- GRANT 권한 ON 테이블 TO 사용자;

---

### 20. 데이터베이스 관리자가 권한을 회수하는 DCL문을 작성

- 관리자가 사용자 장길산에게 '학생'테이블에 대해 UPDATE할 수 있는 권한을 회수
  - `REVOKE UPDATE ON 학생 FROM 장길산;`

>- REVOKE 권한 ON 테이블 FROM 사용자

---

### 21. 순위함수를 사용하는 SQL문 작성

- RANK 함수를 이용하여 연봉을 높은 순에서 낮은 순으로 정렬함
  - `SELECT 이름, 연봉, RANK() OVER(ORDER BY 연봉 DESC) 순위 FROM 사원;`

>- 순위를 구하기 위해 RANK를 이용할 수 있다.
>- RANK는 특정항목(컬럼)에 대한 순위를 구하며 동일 순위의 레코드 존재 시 후 순위는 넘어간다.
>- SELECT 절에서 연봉을 높은 순에서 낮은 순으로 정렬하고 RANK 함수를 이용한다.

---

### 22. 테이블 및 컬럼명에 대한 명세이다. 나이가 25세 이하인 직원들의 급여를 250으로 변경하는 쿼리를 작성하시오

- 테이블명: EMPLOYEE(직원 테이블)
- 컬럼명: NAME(사원명), AGE(나이), SALARY(급여)
  - `UPDATE EMPLOYEE SET SALARY=250 WHERE AGE <= 25;`

>- UPDATE 테이블명 SET 속성명=데이터, ... WHERE <=> 조건;

---

### 23. 관리자가 사용자 홍길동에게 '학생' 테이블에 대해 조회할 수 있는 권한을 회수하는 쿼리를 작성

- `REVOKE SELECT ON 학생 FROM 홍길동;`

>- REVOKE 명령어 (리 온 프)
>- REVOKE 권한 ON 테이블 FROM 사용자

---

### 24. DBMS에서 지원하는 기능은?

- DBMS에서 지원하는 기능이며, 일련의 쿼리들을 마치 하나의 함수처럼 실행하기 위한 쿼리의 집합으로 반환 값을 출력하지 않는 기능은?
  - `프로시저`

|||
|:--:|--|
|프로시저|일련의 쿼리들을 마치 하나의 함수처럼 실행하기 위한 쿼리의 집합|
|사용자</br>정의 함수|일련의 SQL 처리를 수행하고, 수행 결과를 단일 값으로 반환할 수 있는 절차형 SQL|
|트리거|데이터베이스 시스템에서 삽입, 갱신, 삭제 등의 이벤트가 발생할 때마다 관련 작업이 자동으로 수행되는 절차형 SQL|
|||
