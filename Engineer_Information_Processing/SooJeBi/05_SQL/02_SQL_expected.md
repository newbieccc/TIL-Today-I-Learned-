# SQL 응용

## # 응용 SQL - 예상문제

### 01. 평균을 구하는 쿼리 작성

- 급여 테이블에서 부서명과 부서별 급여의 평균을 구하는 쿼리를 구하시오

- 급여 테이블

|이름|직책|부서|급여|
|:--:|:--:|:--:|:--:|
|문무왕|차장|마케팅|5,000|
|박혁거세|차장|전산|4,800|
|장보고|사원|마케팅|4,000|
|김유신|사원|마케팅|4,000|
|||||

- `SELECT 부서, AVG(급여) FROM 급여 GROUP BY 부서;`

---

### 02. 쿼리 작성

- 급여 테이블에서 부서와 직책별 급여의 합계를 구하는 쿼리를 구하시오

|이름|직책|부서|급여|
|:--:|:--:|:--:|:--:|
|문무왕|차장|마케팅|5,000|
|박혁거세|차장|전산|4,800|
|장보고|사원|마케팅|4,000|
|김유신|사원|마케팅|4,000|
|||||

- `SELECT 부서, 직책, SUM(급여) AS 급여 FROM 급여 GROUP BY 부서, 직채;`

---

### 03. 쿼리 작성

- 학생 테이블에서 평균 성적이 4.0을 초과하는 학생의 이름을 출력하는 쿼리를 작성하시오

- 학생 테이블

|이름|과목|성적|
|:--:|:--:|:--:|
|문무왕|프로그래밍|4.5|
|문무왕|알고리즘|4.5|
|장보고|알고리즘|3.5|
|장보고|자료구조|4.5|
||||

- `SELECT 이름 FROM 학생 GROUP BY 이름 HAVING AVG(성적) > 4.0;`

---

### 04. 쿼리 작성

- 학교 테이블

|학교명|학년|인원|
|:--:|:--:|:--:|
|A|1|51|
|A|2|29|
|A|3|15|
|B|1|33|
|B|2|44|
|B|3|72|
||||

- 결과 테이블

|학교명|학년|인원|
|:--:|:--:|:--:|
|A|1|51|
|A|2|29|
|A|3|15|
|||95|
|B|1|33|
|B|2|44|
|B|3|72|
|||149|
|||244|
||||

- `SELECT 학교명, 학년, SUM(인원) AS 인원 FROM 학교 GROUP BY ROLLUP(학교명, 학년);`

>- ROLLUP에 의해 지정된 컬럼은 소계(소그룹의 합계)등 중간 집계 값을 산출하기 위해 사용된다

---

### 05. 쿼리 작성

- 학생 테이블

|이름|점수|
|:--:|:--:|
|장길산|100|
|임꺽정|100|
|홍길동|90|
|김철수|80|
|한유리|70|
|||

- 결과 테이블

|이름|점수|등수|
|:--:|:--:|:--:|
|장길산|100|1|
|임꺽정|100|1|
|홍길동|90|2|
|김철수|80|3|
|한유리|70|4|
|||

- `SELECT 이름, 점수, DENSE_RANK() OVER(ORDER BY 점수 DESC) AS 등수 FROM 학생;`

>- 동일 순위의 레코드 존재 시에도 후순위를 넘어가지 않는 경우(2위가 3개인 레코드인 경우: 2위, 2위 2위, 3위, 4위...) DENSE_RANK 함수를 사용한다
