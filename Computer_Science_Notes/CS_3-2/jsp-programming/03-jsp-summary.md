# # JSP프로그래밍

## 03. JSP 개요

- 컴퓨터과학과 김희천 교수님

### (1) JSP 기술

- JSP 발전 과정
    - JavaServer Pages(JSP) 역사
        - 1999년 Sun Microsystems가 최초 발표
            - 서블릿 기반으로 웹 응용의 프레젠테이션 계층을 구현하기 위해 고안됨
        - JSP 2.3은 Java EE 8(2017)에 포함되어 있음
        - 오라클은 Java EE를 이클립스 재단에 이관함
        - JSTL과 EL은 JSP의 확장 기술
            - 스크립트릿 없이 JSP 페이지를 쉽고 간결하게 작성할 수 있음
    - 현재
        - 이클립스 재단이 Jakarta EE를 관리
            - JSP, EL, JSTL는 모두 Jakarta EE의 하위 독립 사양
        - 최신 버전은 Jakarta EE 11(2024)과 Jakarta Server Pages(JSP) 4.0, Servlet6.1, EL6.0, JSTL3.0

- 정적 데이터와 동적 데이터
    - 템플릿 데이터
        - 정적 데이터라 하며, HTML이나 XML 등으로 구성된 고정된 콘텐츠
        - 응답 문서를 만들 때, 그대로 출력되는 정적인 데이터
        - 예:
            - `<h1> Hello, JSP! </h1>`
    - 동적 데이터
        - JSP 태그로 표현되는 프로그래밍적 요소(JSP요소)
        - 적절한 Java 코드로 변환되고 처리되어 동적 컨텐츠가 생성됨
        - 예
            - `<% out.println(new java.util.Date(); %>`

### (2) JSP 페이지 작성하기

- JSP 페이지는 HTML 문서 구조에 기초함
    - HTML이 기본 틀이며, 필요한 경우 자바 코드를 삽입
        - `<% out.println(new java.util.Date(); %>`
            - 지시어
            - 페이지의 전반적 속성 설정
        - `<html> 태그 또는 텍스트 </html>`
            - 템플릿 데이터
            - 클라이언트에게 그대로 전달됨
        - `<% ... %>와 같은 JSP 요소`
            - 동적인 로직을 처리하는 자바 코드
- 동적 콘텐츠 생성을 위한 JSP 요소
    - 스크립트 요소(scripting elements)
        - 자바 코드이며, 스크립트릿, 표현식, 선언의 형태가 있음
            - 스크립트릿
                - JSP 페이지에 삽입되는 자바 코드
                - `<%  %>`
            - 표현식
                - 출력을 위한 수식
                - `<%= %>`
            - 선언
                - 변수나 메소드의 선언
                - `<%! %>`
    - 지시어(directives)
        - JSP 페이지에 대한 전역적 설정 정보를 지정
            - 서블릿 소스 코드로 변환될 때 사용되는 정보를 지정
        - 기본 형식
            - `<%@ 지시어 이름 속성1="값1"% 속성2="값2">`
            - 종류
                - `<%@page %>`
                    - JSP 페이지 전체에 적용되는 속성을 설정
                - `<%@include file = "파일이름" %>`
                    - 변환 전에 삽입시킬 텍스트 파일을 지정(정적 include)
                - `<%@taglib prefix="c" uri="jakarta.tags.core" %>`
                    - 사용할 태그 라이브러리를 선언
    - 액션 태크(action tags)
        - XML 기반 태그로 자바 코드를 대신해 JSP 동작을 제어
        - 요청을 처리할 때 특별한 동작을 수행하도록 만들어진 태그
            - XML 태그와 같은 형태로, 두 가지 형식이 있음
                - 표준 액션 태그는 접두어로 jsp:가 붙음
            - `<jsp: 액션이름 속성="값" .../>`
            - `<jsp: 액션이름 속성="값" ...> 자식 태그 </jsp:액션이름>`
        - 종류
            - `<jsp:include page="파일명" />`
            - `<jsp:forward page="파일명" />`
            - `<jsp:param name="이름" value="값" />`
            - `<jsp:useBean id="객체이름" class="클래스이름" />`
    - 내장 객체(implicit objects)
        - JSP에 자동으로 제공되는 객체
            - 웹 컨테이너는 JSP 실행을 위해 필요한 내장 객체를 자동 생성
                - JSP 페이지의 스크립트릿이나 표현식에서 선언하지 ㅇ낳고도 사용할 수 있는 자바 객체
                - 종류
                    - request, response, session, application, out
                        - 요청 정보, 응답의 제어, 세션 처리, 웹 애플리케이션 정보, 응답 몸체 만들기
                    - config, page, pageContext, exception
                - 사용 예
                    - `<%out.println(request.getParameter("name"));%>`
    - 표현 언어(Expression Language, EL)
        - 데이터를 수비게 다루기 위한 간단한 수식 언어
            - 형태는 `${expr}`이며 값을 표현
                - 표현식 `<%= %>`을 사용하지 않고도 간단히 값을 출력할 수 있음
                - 표현 언어 자체의 내장 객체를 제공
            - 스크립트 요소의 밖에서 사용해야 함
                - 액션 태그의 속성 값을 설정하거나 텍스트를 출력할 때 사용
                - 표현 언어의 내장 객체나 JSTL과 함께 사용할 수 있음
            - 사용 예
                - `<p>안녕하세요. ${param.name}님!</p>`
                    - `<%= request.getParameter("name")%>`
- JSTL과 사용자 정의 태그
    - JSTL(JSP Standard Tag Library)
        - 자주 사용되는 기능을 태그로 만들어 쓸 수 있음
        - JSTL은 그러한 기능을 태그로 표준화한 태그 모음
        - 조건문, 반복문, 포맷 처리 등의 프로그래밍적 요소를 태그 형태로 제공
        - 예: forEach문
    - 사용자 정의 태그
        - 사용자가 직접 구현한 커스텀 태그
        - JSP 표준 태그를 확장하기 위한 것

### (3) page 지시어

- JSP 페이지에 대한 설정 정보를 지정
    - 개별 설정은 page 지시어에서 속성으로 지정하며, JSP 페이지가 서블릿 코드로 변환 될 때 반영됨
    - 여러 속성을 한 줄에 함께 설정하거나 여러 줄로 나누어 설정해도 무방함

| 속성            | 설명                                                                    | 기본 값      |
|---------------|-----------------------------------------------------------------------|-----------|
| `autoFlush`   | 'true'일 경우 버퍼가 차면 자동으로 버퍼를 비워 내용을 클라이언트에 보냄. 'false'일 경우 버퍼가 차면 예외 발생 | true      |
| `contentType` | 결과로 생성되는 응답의 종류(MIME 타입)와 사용될 charset 정보를 설정                          | text/html |
| `import`      | JSP 페이지에서 사용할 자바 클래스를 지정                                              |           |
| `language`    | JSP 페이지의 스크립트 요소에서 사용할 프로그래밍 언어를 설정                                   | java      |
| `session`     | JSP 페이지에서 session 객체를 사용할 지의 여부를 지정                                   | true      |
| `buffer`      | JSP 페이지의 출력 버퍼 크기를 지정. 'none'일 경우 버퍼를 사용하지 않음                         | 8kb       |

| 속성                         | 설명                                                                                     | 기본 값  |
|----------------------------|----------------------------------------------------------------------------------------|-------|
| `info`                     | JSP 페이지에 대한 설명을 텍스트로 입력할 때 사용                                                          |       |
| `errorPage`                | JSP 페이지 실행 중 에러가 발생할 때 보여줄 페이지를 설정                                                     |       |
| `isErrorPage`              | 현재 페이지가 에러 페이지인지의 여부를 지정. `true`이면 현재 페이지를 에러페이지로 사용할 수 있고, `false`이면 에러 페이지로 사용할 수 없음 | false |
| `pageEncoding`             | JSP 페이지 자신의 문자 인코딩을 지정                                                                 |       |
| `isELIgnored`              | 표현 언어를 사용할 지를 지정                                                                       | false |
| `trimDirectiveWhitespaces` | 지시어로 인해 생성되는 불필요한 공백 문자를 제거할 지를 지정                                                     | false |

- 응답 문서의 MIME 유형 설정
    - contentType 속성

### (4) 스크립트 요소

- 동적 콘텐츠를 생성하기 위한 자바 프로그램 조각
    - JSP 페이지에서 HTML과 섞여 있는 자바 코드
    - `<% ... %>` 태그 안에 자바 코드 작성
- 표현식
    - 변수나 수식의 값을 응답의 결과에 포함시키기 위한 것
        - 스크립트릿을 사용하지 않고 출력하는 방법
        - `<%= 수식 %>` 형태로 세미콜론이 없음
            - 수식의 결과는 문자열로 출력됨
            - `<% out.println(수식); %>`과 동일한 의미
- 선언
    - 스크립트릿이나 표현식에서 사용할 변수나 메서드를 선언
        - 서블릿 클래스의 메서드 또는 변수(필드)를 선언 할 때 사용
            - 선언된 메서드나 변수는 스크립트릿이나 표현식에서 사용 가능
        - 메서드나 변수는 사용 전에 먼저 선언되어야 함
        - `<%! 메서드 or 변수의 선언%>` 현태
