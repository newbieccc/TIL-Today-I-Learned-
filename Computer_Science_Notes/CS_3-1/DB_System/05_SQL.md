# 데이터베이스 시스템

## 05. SQL(2)

- 컴퓨터과학과 정재화 교수님

### (1) 데이터의 삽입

- 데이터 조작 언어의 개념
    - 데이터 정의 언어로 정의된 데이터베이스 내의 데이터에 대해 여러 연산을 수행하기 위한 명령어의 집합
        - 사용자에게 데이터베이스에 저장된 데이터를 처리할 수 있게 하는 일체의 도구를 제공
        - 정의된 테이블 등에 레코드를 삽입, 수정, 삭제 및 검색 하는데 사용되는 SQL 명령어들의 집합
    - 데이터 조작언어는 실행 즉시 반영되는 영구적 변경을 위한 명령어의 집합이 아니며 복구가 가능
- 명령어의 종류
    - INSERT : 삽입
    - UPDATE : 수정
    - DELETE : 삭제
    - SELECT : 검색

- INSERT 명령어
    - 테이블에 새로운 레코드를 삽입하는 명령어
        - 모든 컬럼또는 부분 컬럼에 대한 컬럼값을 입력
        - NOT NULL 제약 조건이 있는 컬럼은 반드시 컬럼값을 입력
        - 문자와 날짜 값은 따옴표(')로 처리
    - INSERT INTO 테이블이름 VALUES(값1, 값2, ... 값n)
    - INSERT INTO 테이블이름 (컬럼1, 컬럼2, ... 컬럼n) VALUES(값1, 값2, ... 값n)

### (2) 데이터의 수정과 삭제

- UPDATE 명령어
    - 조건을 만족하는 레코드의 특정 컬럼값을 수정
    - UPDATE 테이블이름 SET 컬럼1=값1, 컬럼2=값2 WHERE 조건
- DELETE 명령어
    - 조건에 일치하는 레코드 집합을 테이블에서 삭제할 때 사용하는 명령어
    - DELETE FROM 테이블이름 WHERE 조건
- WHERE를 붙히지 않고 실행하면, 전체 테이블 대상으로 실행

### (3) 데이터의 검색

- SELECT 명령어

```SQL
SELECT [DISTINCT] 컬럼1, 컬럼2, 컬럼n
FROM 테이블1 [INNER JOIN | OUTER JOIN
    테이블2 INNER JOIN | OUTER JOIN
ON 조인 조건식1
    테이블3
    ...INNER JOIN | OUTER JOIN
    테이블 m
    ON 조인 조건식n]
    [
WHERE 조건식 [중첩질의]]
    [
GROUP BY 컬럼1, 컬럼2, ...컬럼y]
    [
HAVING 조건]
    [
ORDER BY 컬럼1 [ASC | DESC], ...컬럼z [ASC | DESC]]
```

- SELECT의 구문형식
    - SELECT 절 : 결과에 포함되는 컬럼을 지정
    - FROM 절 : 질의를 적용할 테이블을 지정
    - ON 절 : 조인 조건을 지정
    - WHERE 절 : 검색 대상 레코드의 조건을 지정
    - GROUP BY 절 : 레코드를 그룹화하기 위한 그룹 조건을 지정
    - HAVING 절 : GROUP BY 절이 적용된 결과에 대한 조건을 지정
    - ORDER BY 절 : 검색 결과의 정렬 기준을 지정

- 단순 SELECT문
    - 레코드를 제한하지 않고 전체 테이블을 검색하는 SELECT 문
        - WHERE 절이 없는 질의문
        - DISTINCT 키워드를 통해 중복 제거 가능
    - SELECT [DISTINCT] 컬럼1, 컬럼2, ... 컬럼n FROM 테이블
        - 중복 제거
    - SELECT * FROM 테이블
        - 전체 조회
- 조건 SELECT문
    - 산술연산식, 함수 등을 사용하여 표현한 조건을 WHERE 절에 기술하여 조건을 만족하는 레코드만 선택적으로 검색하는 SELECT 문
        - 산술연산자
            - 컬럼값 또는 상수와의 산술 연산을 위한 연산자
            - DIV, /, - MOD(%), +, *
        - 비교연산자
            - 컬럼값과 상수의 크기를 비교하는 연산자
            - =, <>(!=), >, >=, <, <=
        - 논리연산자
            - 두 개 이상의 조건이 기술되는 질의문에서 조건식 간의 관계를 정의하는 연산자
            - AND, OR, NOT
    - WHERE 절은 UPDATE, DELETE 문 등 조건을 기술하여 선택적으로 레코드에 적용하는 명령문에서 동일하게 사용
