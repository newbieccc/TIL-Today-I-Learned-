# 데이터베이스 시스템

## 09. 저장 객체

- 컴퓨터과학과 정재화 교수님

### (1) 저장 프로시저

- 데이터베이스 언어의 특징
    - SQL
        - DBMS에 대한 강력한 작업 지시 기능을 제공
        - 인간의 언어와 매우 유사하고 간단, 명료
        - 비절차적(선언형) 언어, 필요한 데이터만 기술
    - 비절차적 언어(non-procedural language)
        - 목표만 명시하고 수행에 대한 절차는 기술하지 않음
        - 높은 가독성과 동작 순서에 대한 구체적 기술이 없어 오류가 상대적으로 적은 점이 장점
        - 프로그램의 성능 최적화, 디버깅, 오류 추적 및 복잡한 로직 구현이 한계
            - 저장 객체를 통해 SQL의 단점을 보완
- 저장 객체의 이해와 종류
    - 저장 객체의 정의
        - SQL 문을 확장하여 절차적으로 처리하기 위한 기능을 제공하는 언어
        - SQL/PSM(Persistent Stored Module) 기반의 확장 언어
    - 저장 객체의 장점
        - 네트워크 전송 효율 : 클라이언트와 DBMS 사이에 트래픽 감소
        - 효율적 실행 속도 : 저장 객체는 컴파일 되어 캐시에 저장
        - 모듈화 : 대규모 작업의 시간 단축, 프로그램 크기의 축소
        - 보안성 향상 : 사용자별, 작업 단위별로 권한 부여 가능
    - 저장 객체의 단점
        - 처리 성능 저하 : 서버 메모리 사용량이 증가로 인한 성능 저하
        - 어려운 디버깅 : 저장 객체를 위한 디버깅 환경 미지원
    - 저장 객체의 종류
        - 저장 프로시저
            - 자주 사용되거나 복잡한 과정을 거치는 SQL문을 저장하여 하나의 개체로 관리
        - 함수
            - 저장 프로시저의 유사, 결과값을 반환하는 기능 제공
            - SELECT 문에 포함되어 실행
        - 트리거
            - 데이터 갱신 시 지정된 애플리케이션이 동작 또는 다른 테이블의 데이터를 변경
- 저장 프로시저의 이해
    - 저장 프로시저의 정의
        - 응용 작업 중 자주 사용되거나 다수의 SQL 문으로 구성되는 복잡한 과정이 저장된 개체
        - 데이터를 주고받는 여러 개의 SQL 문을 묶어서 단계별로 실행
    - 저장 프로시저의 특징
        - 함수와는 달리 이름을 이용하여 값을 반환하지 않음
        - 매개변수를 받아들이거나 반환
        - 프로시저 내에서 또 다른 프로시저 호출 가능
        - 실행과 관련된 제어값과 메시지를 반환
    - 저장 프로시저의 수정
        - 삭제 후 재생성 -> 모든 저장 객체 동일
    - 저장 프로시저의 삭제
        - DROP PROCEDURE GetStudentByGender;
- 매개변수의 사용
    - 매개변수의 역할
        - 외부로부터 주어지는 값이나 기본값을 매개변수를 통해 저장 프로시저로 전달
        - 저장 프로시저를 실행한 결과값을 반환
- 변수의 사용
    - 저장 객체에서 처리하는 응용 과정에서 발생하는 임시적인 값을 저장하고 재사용하는 기능 제공
        - 사용자 정의 변수 : @ 시작, 별도의 선언 없이 사용
        - 로컬 변수 : 저장 객체 내에서만 사용, DECLARE로 선언
- 저장 객체의 활용

### (2) 함수

- 함수의 이해
    - DBMS는 문자함수, 숫자함수, 날짜함수, 집계함수 등 많은 편리한 함수를 제공
    - 사용자가 프로그래밍 언어의 기능을 사용하여 직접 함수를 정의하는 사용자 정의 함수 기능을 제공
    - 저장 프로시저와 함수의 차이
        - 저장 프로시저는 OUT 매개변수를 통해 결과를 반환, 함수는 RETURN문에 의해 특정 값을 반환
        - 저장 프로시저는 CALL 명령에 의해 실행되나, 함수는 SELECT 문에 포함되어 실행 (호출)

### (3) 트리거

- 트리거의 이해
    - 데이터 변경 시 자동으로 지정된 애플리케이션이 동작하거나 다른 테이블의 데이터를 변경하도록 설계된 저장 프로시저의 특별한 형태
    - 트리거의 역할
        - 전체적인 데이터베이스의 무결성과 일관성을 유지하도록 동작
        - 조건에 따른 데이터 적합성 검사 가능
        - 연속적 트리거 실행 시 다른 데이터베이스나 서버에 대한 광범위한 참조 무결성 검사도 가능
