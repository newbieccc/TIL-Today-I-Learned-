# 데이터베이스 시스템

## 11. 인덱싱

- 컴퓨터과학과 정재화 교수님

### (1) 인덱스의 이해

- 인덱스의 개념
    - 데이터 검색 시 발생하는 비효율적인 데이터
    - 입출력 문제를 해결하기 위한 목적으로 시작
        - 인덱스 : 요청된 레코드에 빠르게 접근할 수 있도록 지원하는 데이터와 관련된 부가적인 구조
        - 인덱싱 : 인덱스를 구성하고 생성하는 작업
    - 인덱스의 탐색키를 이용하여 해당 레코드가 저장된 블럭을 위치를 파악하고 해당 블럭을 빠르게 적재
        - 탐색키(검색키) : 파일에서 레코드를 찾는데 사용되는 컬럼이나 컬럼의 집합
- 인덱스 기반의 검색 과정
- 인덱스의 종류
    - 순서 인덱스 : 특정 값에 대해 정렬된 순서 구조
    - 해시 인덱스 : 버킷의 범위 안에서 값의 균일한 분포에 기초한 구조로 해시 함수가 어떤 값이 어느 버킷에 할당되는지 결정
- 인덱스의 평가 기준
    - 접근 시간 : 데이터를 찾는데 소요되는 시간
    - 유지 비용 : 새로운 데이터 삽입 및 기존 데이터 삭제 연산으로 인한 인덱스 구조 갱신 비용
    - 공간 비용 : 인덱스 구조에 의해 사용되는 부가적인 공간 비용

### (2) 순서 인덱스

- 순서 인덱스의 특징
    - 탐색키로 정렬된 순차 파일에 대하여 레코드에 대한 빠른 접근이 가능하도록 구성한 인덱스
        - 탐색키를 정렬하여 해당 탐색키와 탐색키에 대한 레코드와의 연계를 통하여 인덱스 생성
        - 순서 인덱스의 종류
            - 밀집 인덱스
                - 모든 레코드에 대해 탐색키 값, 포인터 쌍을 유지
                - 단점
                    - 레코드 수만큼 인덱스 엔트리 존재.
                    - 인덱스의 크기가 방대해짐
                    - 레코드가 많으면 조회 시 오랜시간 소요
            - 희소 인덱스
                - 인덱스의 엔트리가 일부의 탐색키 값만을 유지
                    - 요청된 탐색키보다 작거나 같은 인덱스의 탐색키 값 중 가장 큰 인덱스 엔트리의 포인터가 가리키는 블럭은ㄹ ㅈ
            - 다단계 인덱스
                - 내부 인덱스와 외부 인덱스로 구성
                    - 외부 인덱스를 내부 인덱스보다 희소한 인덱스로 구성하여 엔트리의 포인터가 내부 인덱스 블롱긍ㄹ
- 인덱스의 구성
- 밀집, 희소, 다단계 인덱스

### (3) B+ 트리 인덱스

- B+ 트리의 구조
    - 루트노드부터 모든 단말노드에 이르는 경로의 길이가 같은 높이 균형 트리
        - 순서 인덱스는 파일이 커질수록 데이터 탐색에 있어서 접근 비용이 커지는 문제점을 해결하기 위해 제안
        - 상용 DBMS에서도 널리 사용되는 대표적인 순서 인덱스
    - B+ 트리 상에서 삽입과 삭제
        - 삽입 : 검색과 같은 방법을 사용하여 삽입되는 레코드의 탐색키 값이 속할 단말 노드를 탐색
            - 해당 단말 노드에 <탐색키, 포인터> 쌍을 삽입
            - 삽입 시 탐색키가 순서를 유지
        - 삭제 : 삭제될 레코드의 탐색키를 통해 삭제될 탐색키와 포인터를 포함한 단말 노드를 탐색
            - 같은 탐색키 값을 가지는 다중 엔트리가 존재할 경우, 삭제될 레코드를 가리키는 엔트리를 찾을 때까지 탐색 후 단말노드에서 제거
            - 단말노드에서 제거된 엔트리의 오른쪽에 있는 엔트리들은 빈 공간이 없도록 왼쪽으로 이동
    - 노드가 분할되는 삽입
        - 부모 노드에 탐색키를 조정하고 추가된 노드에 대한 포인터를 삽입
    - 탐색키의 삭제