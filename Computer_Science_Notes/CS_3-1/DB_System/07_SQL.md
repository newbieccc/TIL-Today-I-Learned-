# 데이터베이스 시스템

## 07. SQL(4)

- 컴퓨터과학과 정재화 교수님

### (1) 중첩 질의의 이해

- 중첩 질의의 개념
- 중첩 질의의 사용

### (2) 조인 질의의 이해

- 조인 질의
    - 테이블 간의 관련성을 이용하여 두 개 이상의 테이블에서 데이터를 검색하는 질의 기법
    - ER 모델링 및 정규화 기법으로 여러 테이블로 분리된 정보를 일시적으로 하나의 레코드로 통합
    - 조인 질의의 종류
        - 내부조인
            - 두 개 이상의 테이블에서 조인 조건을 만족하는 레코드만 결합하여 출력 결과에 포함시키는 연산
            - 조인 조건은 WHERE 절이 아닌 ON 절에 기록
        - 자연조인
            - 두개 이상의 테이블을 하나의 테이블로 결합하는 내부 조인과 매우 유사한 기능
            - 두 테이블에 동일한 이름의 컬럼에 대해 값이 같은 레코드를 결합하는 내부 조인
        - 외부조인
            - 내부 조인(inner join)은 조인조건에 일치하는 레코드만 결합하여 결과를 생성
                - 조인 결과에 정보의 손실이 발생
            - 외부 조인은 조인조건에 맞지 않는 레코드도 질의의 결과에 포함시키는 질의
            - 외부 조인의 종류
                - 왼쪽 외부 조인 (left outer join)
                - 오른쪽 외부 조인 (right outer join)
                - 완전 외부 조인 (full outer join)
        - 셀프 조인
            - 한 테이블이 자기 자신과 조인되는 질의
            - 동일한 테이블에 대한 조인이므로 반드시 테이블 이름에 대한 별칭이 의무적으로 사용
- 데이터베이스 언어의 필요
- SQL의 개요
- SQL의 구성

### (3) 뷰의 사용

- 뷰의 개념
    - 데이터를 저장하고 있는 하나 이상의 테이블을 유도하여 생성하는 가상의 테이블(virtual table)
        - 데이터 독립성 : 원본 테이블의 구조가 바뀌어도 뷰를 이용한 작업은 정의만 변경되어 응용 프로그램에 영향이 없음
        - 데이터 보안 : 사용자에게 원본 테이블의 일부 컬럼에 대한 접근을 허용하여 보안 효과를 향상
        - 다양한 구조의 테이블 사용 : 사용자의 요구사항에 맞는 테이블의 구조를 제공
        - 작업의 단순화 : 족합한 질의문을 뷰로 단순화
        - 데이터 무결성 : WITH CHECK OPTION을 이용하여 뷰 생성에 위배되는 수정작업을 거부
- 뷰 생성, 수정, 삭제
    - 생성
        - CREATE VIEW 뷰이름 AS (SELECT 컬럼1,... 컬럼n FROM 테이블 WHERE 조건) [WITH CHECK OPTION]
    - 수정
        - ALTER VIEW 뷰이름 (컬럼1, ...컬럼n) AS (SELECT 컬럼1,...컬럼n FROM 테이블 WHERE 조건)
    - 삭제
        - DROP VIEW 뷰이름
- 뷰를 이용한 검색 및 수정

- 뷰를 이용한 데이터 삽입
    - 뷰에 대한 INSERT 문은 원본 테이블에서 실행
    - INSERT 문 실행이 불가능한 경우
        - PRIMARY KEY, NOT NULL 등의 제약사항이 위배되는 경우 삽입이 불가능
        - 원본 테이블에 존재하는 컬럼이지만 뷰에는 없는 컬럼에 삽입하는 경우 실행 불가능
        - 조인 질의 또는 그룹 질의가 적용된 뷰는 데이터 삽입 및 수정이 불가능
        - WITH CHECK OPTION이 적용된 뷰는 위배되는 사항은 없지만 뷰에 맞지 않는 조건일 경우 실행 불가능